// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i,s;e=jQuery;n=localStorage;t=0;r=function(){var e;DEBUG&&console.log("\n#"+t);if(n.useInfoscreen!=="true"){t%UPDATE_OFFICE_INTERVAL===0&&s();t%UPDATE_NEWS_INTERVAL===0&&navigator.onLine&&i()}1e4<t?t=0:t++;DEBUG||!navigator.onLine||n.currentStatus==="error"?e=BACKGROUND_LOOP_QUICK:e=BACKGROUND_LOOP;return setTimeout(function(){return r()},e)};s=function(){DEBUG&&console.log("updateOffice");return Office.get(function(t,r,i){if(n.currentStatus!==t||n.currentStatusMessage!==i){chrome.browserAction.setIcon({path:"img/icon-"+t+".png"});n.currentStatus=t;return Office.getTodaysEvents(function(t){var s;t=e.trim(t);s="### Nå\n"+r+": "+i+"\n\n### Resten av dagen\n"+t;chrome.browserAction.setTitle({title:s});return n.currentStatusMessage=i})}})};i=function(){DEBUG&&console.log("updateNews");return fetchFeed(function(){var e;e=n.lastResponseData;return e!==null?unreadCount(e):console.log("ERROR: response was null")})};e(function(){e.ajaxSetup({timeout:15e3});DEBUG&&n.clear();n.removeItem("currentStatus");n.removeItem("currentStatusMessage");if(n.everConnected===void 0){if(n.first_bus===void 0){n.showBus="true";n.first_bus=16011333;n.first_bus_name="Gløshaugen Nord";n.first_bus_direction="til byen";n.second_bus=16010333;n.second_bus_name="Gløshaugen Nord";n.second_bus_direction="fra byen"}n.showOffice===void 0&&(n.showOffice="true");n.showCantina===void 0&&(n.showCantina="true");n.showNotifications===void 0&&(n.showNotifications="true");n.openChatter===void 0&&(n.openChatter="false");n.useInfoscreen===void 0&&(n.useInfoscreen="false");DEBUG||chrome.tabs.create({url:chrome.extension.getURL("options.html"),selected:!0})}n.useInfoscreen==="true"&&chrome.tabs.create({url:chrome.extension.getURL("infoscreen.html"),selected:!0});n.openChatter==="true"&&chrome.tabs.create({url:"http://webchat.freenode.net/?channels=online",selected:!1});n.everConnected=n.wasConnected="false";setInterval(function(){return document.location.reload()},864e5);return r()})}).call(this);