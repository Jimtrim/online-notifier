// Generated by CoffeeScript 1.4.0
(function(){var e,t,n,r,i,s,o,u,a;e=jQuery;r=localStorage;n=0;i=function(){DEBUG&&console.log("\n#"+n);n%UPDATE_OFFICE_INTERVAL===0&&a();n%UPDATE_NEWS_INTERVAL===0&&u();n%UPDATE_BUS_INTERVAL===0&&s();n%UPDATE_CANTINAS_INTERVAL===0&&o();1e4<n?n=0:n++;return setTimeout(function(){return i()},PAGE_LOOP)};a=function(){DEBUG&&console.log("updateOffice");return Office.get(function(t,n,i){if(r.currentStatus!==t||r.currentStatusMessage!==i){e("#office img").attr("src","img/status-"+t+".png");e("#office #subtext").html(i);r.currentStatus=t;return r.currentStatusMessage=i}})};u=function(){var t;DEBUG&&console.log("updateNews");fetchFeed(function(){var e;e=r.lastResponseData;return e!==null?t(e):console.log("ERROR: response was null")});return t=function(t){var n,i,s,o,u,a,f,l,c,h;a=e.parseXML(t);n=e(a);o=n.find("item");f=e(o[0]).find("guid");h=e(f).text();l=h.split("/")[4];if(r.mostRecentRead===l)return;r.mostRecentRead=l;e("#news").html("");i=[];o.each(function(t,n){var s,o,u;o=r.noDinnerInfo==="true"?4:3;if(t<o){u=parsePost(n);i.push(u.id);s='<div class="post"><span class="read"></span>';s+='            <span class="title">'+u.title+'</span>            <div class="item">              <img id="'+u.id+'" src="'+u.image+'" width="107" />              <div class="textwrapper">                <div class="emphasized">- Av '+u.creator+", skrevet "+u.date+"</div>                "+u.description+"              </div>            </div>          </div>";return e("#news").append(s)}});c=[];for(s in i){u=i[s];c.push(getImageUrlForId(u,function(t,n){return e("#"+t).attr("src",n)}))}return c}};s=function(){var n,i,s;DEBUG&&console.log("updateBus");if(!navigator.onLine){e("#bus #left .name").html(r.first_bus_name);e("#bus #right .name").html(r.second_bus_name);e("#bus #left .first .line").html("Frakoblet");return e("#bus #right .first .line").html("Frakoblet")}i=r.first_bus_name;s=r.second_bus_name;n=4;Bus.getAnyLines(r.first_bus,n,function(e){return t(e,i,"#left")});return Bus.getAnyLines(r.second_bus,n,function(e){return t(e,s,"#right")})};t=function(t,n,r){var i,s,o,u;console.log("cssIdentificator");if(typeof t=="string"){e("#bus "+r+" .name").html(n);return e("#bus "+r+" .first .line").html(t)}e("#bus "+r+" .name").html(n);o=[".first",".second",".third",".fourth",".fifth"];i=0;if(t.departures.length===0)return e("#bus "+r+" "+o[i]+" .line").html("<i>....zzzZZZzzz....</i>");u=[];for(s in t.departures){e("#bus "+r+" "+o[i]+" .line").html(t.destination[s]+" ");e("#bus "+r+" "+o[i]+" .time").html(t.departures[s]);u.push(i++)}return u};o=function(){var t,n,i;DEBUG&&console.log("updateCantinas");t="http://sit.no/rss.ap?thisId=36444&ma=on&ti=on&on=on&to=on&fr=on";i="http://sit.no/rss.ap?thisId=36447&ma=on&ti=on&on=on&to=on&fr=on";Cantina.get(t,function(t){return e("#cantinas #hangaren #dinnerbox").html(n(t))});Cantina.get(i,function(t){return e("#cantinas #realfag #dinnerbox").html(n(t))});return n=function(e){var t,n,i,s,o;n="";if(typeof e=="string"){r.noDinnerInfo="true";n+='<li class="dinnerlist">'+e+"</li>"}else{r.noDinnerInfo="false";for(s=0,o=e.length;s<o;s++){t=e[s];t.price!==null?i=t.price+",- ":i="";n+='<li class="dinnerlist">'+i+t.text+"</li>"}}return n}};e(function(){r.removeItem("mostRecentRead");r.removeItem("currentStatus");r.removeItem("currentStatusMessage");if(OPERATING_SYSTEM==="Windows"){e("#pagefliptext").attr("style","bottom:9px;");e("#pagefliplink").attr("style","bottom:9px;")}setInterval(function(){return e(".pageflipcursor").animate({opacity:0},"fast","swing",function(){return e(this).animate({opacity:1},"fast","swing")})},600);setInterval(function(){var t,n,r;r=Math.ceil(Math.random()*25);t=function(){var e,t;t=[];for(n=e=0;0<=r?e<=r:e>=r;n=0<=r?++e:--e)t.push("<br />");return t}().join(" ");e("#overlay").html(t+"preventing image burn-in...");e("#overlay").css("opacity",1);return setTimeout(function(){return e("#overlay").css("opacity",0)},3500)},18e5);setInterval(function(){return document.location.reload()},864e5);return i()})}).call(this);